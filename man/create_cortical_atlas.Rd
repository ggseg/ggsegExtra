% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/atlas-cortical.R
\name{create_cortical_atlas}
\alias{create_cortical_atlas}
\title{Create cortical atlas from FreeSurfer annotation}
\usage{
create_cortical_atlas(
  input_annot,
  atlas_name = NULL,
  output_dir = NULL,
  hemisphere = c("rh", "lh"),
  views = c("lateral", "medial", "superior", "inferior"),
  tolerance = NULL,
  smoothness = NULL,
  cleanup = NULL,
  verbose = get_verbose(),
  skip_existing = NULL,
  steps = NULL
)
}
\arguments{
\item{input_annot}{Character vector of paths to annotation files.
Files should follow FreeSurfer naming convention with \code{lh.} or \code{rh.}
prefix (e.g., \code{c("lh.aparc.annot", "rh.aparc.annot")}).}

\item{atlas_name}{Name for the atlas. If NULL, derived from the input
filename.}

\item{output_dir}{Directory to store intermediate files (screenshots, masks,
contours). Defaults to \code{\link[=tempdir]{tempdir()}}.}

\item{hemisphere}{Which hemispheres to include: "lh", "rh", or both.}

\item{views}{Which views to include: "lateral", "medial",
"superior", "inferior".}

\item{tolerance}{Simplification tolerance for 2D polygons. Higher values
produce simpler shapes with fewer vertices. Passed to \code{\link[sf:geos_unary]{sf::st_simplify()}}.
If not specified, uses \code{options("ggsegExtra.tolerance")} or the
\code{GGSEGEXTRA_TOLERANCE} environment variable. Default is 0 (no simplification).}

\item{smoothness}{Smoothing factor for 2D contours. Higher values produce
smoother region boundaries. Passed to \code{\link[smoothr:smooth]{smoothr::smooth()}}. If not
specified, uses \code{options("ggsegExtra.smoothness")} or the
\code{GGSEGEXTRA_SMOOTHNESS} environment variable. Default is 5.}

\item{cleanup}{Remove intermediate files after atlas creation. If not
specified, uses \code{options("ggsegExtra.cleanup")} or the \code{GGSEGEXTRA_CLEANUP}
environment variable. Default is TRUE.}

\item{verbose}{Logical. If not specified, uses the value from
\code{options("ggsegExtra.verbose")} or the \code{GGSEGEXTRA_VERBOSE}
environment variable. Defaults to \code{TRUE}.
Use \code{options(ggsegExtra.verbose = FALSE)} to suppress output globally.}

\item{skip_existing}{Skip generating output files that already exist,
allowing interrupted atlas creation to resume. If not specified, uses
\code{options("ggsegExtra.skip_existing")} or the \code{GGSEGEXTRA_SKIP_EXISTING}
environment variable. Default is TRUE.}

\item{steps}{Which pipeline steps to run. Default NULL runs all steps.
Steps are:
\itemize{
\item 1: Read annotation files and build 3D atlas
\item 2: Take full brain snapshots
\item 3: Take region snapshots
\item 4: Isolate regions from images
\item 5: Extract contours
\item 6: Smooth contours
\item 7: Reduce vertices
\item 8: Build final atlas with 2D geometry
}
Use \code{steps = 1} for 3D-only atlas. Use \code{steps = 1:4} to stop before
contour extraction. Use \code{steps = 6:7} to iterate on smoothing and
reduction parameters without re-extracting contours.}
}
\value{
A \code{brain_atlas} object containing region metadata (core), vertex
indices for 3D rendering, a colour palette, and optionally sf geometry
for 2D plots.
}
\description{
\ifelse{html}{\href{https://lifecycle.r-lib.org/articles/stages.html#maturing}{\figure{lifecycle-maturing.svg}{options: alt='[Maturing]'}}}{\strong{[Maturing]}}

Turn FreeSurfer annotation files into a brain atlas you can plot with
ggseg and ggseg3d. The function reads the annotation, extracts which
vertices belong to each brain region, and (optionally) generates 2D
polygon outlines for flat brain plots.

Use the \code{steps} parameter to control which pipeline steps to run. For
3D-only atlases, use \code{steps = 1}. For iterating on contour parameters,
use \code{steps = 6:7} to re-run smoothing and reduction without regenerating
snapshots.
}
\examples{
\dontrun{
# Create 3D-only atlas from annotation files
atlas <- create_cortical_atlas(
  input_annot = c("lh.yeo7.annot", "rh.yeo7.annot"),
  steps = 1
)

# Create full atlas with 2D geometry (requires FreeSurfer for rendering)
atlas <- create_cortical_atlas(
  input_annot = c("lh.aparc.DKTatlas.annot", "rh.aparc.DKTatlas.annot")
)
ggseg(atlas = atlas)

# Iterate on smoothing parameters
atlas <- create_cortical_atlas(
  input_annot = c("lh.aparc.annot", "rh.aparc.annot"),
  steps = 6:8,
  smoothness = 10,
  tolerance = 0.5
)
}
}
