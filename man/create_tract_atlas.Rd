% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/atlas-tracts.R
\name{create_tract_atlas}
\alias{create_tract_atlas}
\title{Create brain atlas from white matter tracts}
\usage{
create_tract_atlas(
  input_tracts,
  input_aseg = NULL,
  atlas_name = NULL,
  input_lut = NULL,
  tube_radius = 5,
  tube_segments = 8,
  n_points = 50,
  centerline_method = c("mean", "medoid"),
  views = NULL,
  output_dir = NULL,
  verbose = get_verbose(),
  tolerance = NULL,
  smoothness = NULL,
  cleanup = NULL,
  skip_existing = NULL,
  dilate = NULL,
  vertex_size_limits = NULL,
  steps = NULL
)
}
\arguments{
\item{input_tracts}{Paths to tractography files (\code{.trk} or \code{.tck}), or a
named list of coordinate matrices where each matrix has N rows and 3
columns (x, y, z).}

\item{input_aseg}{Path to a segmentation volume (\code{.mgz}, \code{.nii}) used to
draw cortex outlines in 2D views. Required for steps 2+.}

\item{atlas_name}{Name for the atlas. If NULL, derived from the input
filename.}

\item{input_lut}{Path to a color lookup table (LUT) file, or a data.frame
with columns \code{region} and colour columns (R, G, B or hex).
Use this to provide tract names and colours. If NULL, names are derived
from filenames or list names, and the atlas will have no palette.}

\item{tube_radius}{Controls the tube thickness. Either a single numeric
value for uniform radius, or \code{"density"} to scale radius by how many
streamlines pass through each point.}

\item{tube_segments}{Number of segments around the tube circumference.
Higher values make smoother tubes but larger meshes. Default 8 is a
good balance.}

\item{n_points}{Number of points to resample the centerline to. All tracts
are resampled to this length for consistent tube generation.}

\item{centerline_method}{How to extract the centerline from multiple
streamlines: \code{"mean"} averages coordinates point-by-point, \code{"medoid"}
selects the single most representative streamline.}

\item{views}{A data.frame specifying projection views. If NULL, uses
\code{\link[=default_tract_views]{default_tract_views()}}.}

\item{output_dir}{Directory to store intermediate files (screenshots, masks,
contours). Defaults to \code{\link[=tempdir]{tempdir()}}.}

\item{verbose}{Logical. If not specified, uses the value from
\code{options("ggsegExtra.verbose")} or the \code{GGSEGEXTRA_VERBOSE}
environment variable. Defaults to \code{TRUE}.
Use \code{options(ggsegExtra.verbose = FALSE)} to suppress output globally.}

\item{tolerance}{Simplification tolerance for 2D polygons. Higher values
produce simpler shapes with fewer vertices. Passed to \code{\link[sf:geos_unary]{sf::st_simplify()}}.
If not specified, uses \code{options("ggsegExtra.tolerance")} or the
\code{GGSEGEXTRA_TOLERANCE} environment variable. Default is 0 (no simplification).}

\item{smoothness}{Smoothing factor for 2D contours. Higher values produce
smoother region boundaries. Passed to \code{\link[smoothr:smooth]{smoothr::smooth()}}. If not
specified, uses \code{options("ggsegExtra.smoothness")} or the
\code{GGSEGEXTRA_SMOOTHNESS} environment variable. Default is 5.}

\item{cleanup}{Remove intermediate files after atlas creation. If not
specified, uses \code{options("ggsegExtra.cleanup")} or the \code{GGSEGEXTRA_CLEANUP}
environment variable. Default is TRUE.}

\item{skip_existing}{Skip generating output files that already exist,
allowing interrupted atlas creation to resume. If not specified, uses
\code{options("ggsegExtra.skip_existing")} or the \code{GGSEGEXTRA_SKIP_EXISTING}
environment variable. Default is TRUE.}

\item{dilate}{Dilation iterations for 2D polygons. Useful for filling small
gaps between structures.}

\item{vertex_size_limits}{Numeric vector of length 2 setting minimum and
maximum vertex count for polygons. Polygons outside this range are
filtered out. Default NULL applies no limits.}

\item{steps}{Which pipeline steps to run. Default NULL runs all steps.
Steps are:
\itemize{
\item 1: Read tractography and create tube meshes
\item 2: Create projection snapshots
\item 3: Process images
\item 4: Extract contours
\item 5: Smooth contours
\item 6: Reduce vertices
\item 7: Build atlas
}
Use \code{steps = 1} for 3D-only atlas. Use \code{steps = 5:7} to iterate on
smoothing and vertex reduction.}
}
\value{
A \code{brain_atlas} object with type \code{"tract"}, containing region
metadata, tube meshes for 3D rendering, colours, and optionally sf
geometry for 2D projection plots.
}
\description{
\ifelse{html}{\href{https://lifecycle.r-lib.org/articles/stages.html#experimental}{\figure{lifecycle-experimental.svg}{options: alt='[Experimental]'}}}{\strong{[Experimental]}}

Turn tractography streamlines into a brain atlas where each tract is
rendered as a 3D tube. The function computes a centerline from the
streamlines and generates a tube mesh around it.

You can provide tract data in several formats: TRK files from TrackVis,
TCK files from MRtrix, or coordinate matrices directly in R. The function
reads the streamlines, extracts a representative centerline (by averaging
or selecting the medoid), and builds a tube mesh for 3D rendering.

For tracts with many streamlines, set \code{tube_radius = "density"} to make
the tube thicker where more streamlines pass through.
}
\examples{
\dontrun{
# From TRK files (names derived from filenames)
atlas <- create_tract_atlas(
  input_tracts = c("cst_left.trk", "cst_right.trk")
)

# With custom names and colours via LUT
atlas <- create_tract_atlas(
  input_tracts = c("cst_left.trk", "cst_right.trk"),
  input_lut = "tract_colors.txt"
)

# View with ggseg3d
ggseg3d(atlas = atlas)
}
}
