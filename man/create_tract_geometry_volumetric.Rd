% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/atlas-tracts.R
\name{create_tract_geometry_volumetric}
\alias{create_tract_geometry_volumetric}
\title{Create 2D geometry for tract atlas}
\usage{
create_tract_geometry_volumetric(
  atlas,
  aseg_file,
  streamlines,
  views = NULL,
  cortex_slices = NULL,
  output_dir = tempdir(),
  tract_radius = 3,
  cortex_labels = NULL,
  coords_are_voxels = NULL,
  vertex_size_limits = NULL,
  dilate = NULL,
  tolerance = NULL,
  smoothness = NULL,
  verbose = NULL,
  cleanup = NULL,
  skip_existing = NULL
)
}
\arguments{
\item{atlas}{A \code{brain_atlas} of type \code{"tract"} (from \code{\link[=create_tract_atlas]{create_tract_atlas()}}).}

\item{aseg_file}{Path to a segmentation volume (\code{.mgz}, \code{.nii}) used to
draw cortex outlines for anatomical context.}

\item{streamlines}{Named list of streamline matrices (Nx3 with x, y, z).
Names must match tract labels in the atlas. Required because atlas
centerlines are centred for 3D rendering and don't match volumetric space.}

\item{views}{A data.frame defining which projection views to create. Columns:
\code{name} (view label), \code{type} (\code{"coronal"} or \code{"axial"}), \code{start} (first
slice), \code{end} (last slice). Default creates upper/lower coronal and
anterior/posterior axial views.}

\item{cortex_slices}{A data.frame specifying cortex slice positions for
reference outlines. Columns: \code{x}, \code{y}, \code{z}, \code{view}, \code{name}. Default uses
central slices for each view.}

\item{output_dir}{Directory to store intermediate files (screenshots, masks,
contours). Defaults to \code{\link[=tempdir]{tempdir()}}.}

\item{tract_radius}{Dilation radius when rasterising tract coordinates.}

\item{cortex_labels}{Named list with \code{"left"} and \code{"right"} vectors of
label values identifying cortical voxels. Default uses aseg labels
(3 = left, 42 = right). For aparc+aseg, use
\code{list(left = 1000:1999, right = 2000:2999)}.}

\item{coords_are_voxels}{If TRUE, streamline coordinates are in voxel
space (0-indexed). If FALSE, coordinates are in RAS space. If NULL
(default), auto-detects by checking coordinate ranges.}

\item{vertex_size_limits}{Numeric vector of length 2 setting minimum and
maximum vertex count for polygons. Polygons outside this range are
filtered out. Default NULL applies no limits.}

\item{dilate}{Dilation iterations for 2D polygons. Useful for filling small
gaps between structures.}

\item{tolerance}{Simplification tolerance for 2D polygons. Higher values
produce simpler shapes with fewer vertices. Passed to \code{\link[sf:geos_unary]{sf::st_simplify()}}.
If not specified, uses \code{options("ggsegExtra.tolerance")} or the
\code{GGSEGEXTRA_TOLERANCE} environment variable. Default is 0 (no simplification).}

\item{smoothness}{Smoothing factor for 2D contours. Higher values produce
smoother region boundaries. Passed to \code{\link[smoothr:smooth]{smoothr::smooth()}}. If not
specified, uses \code{options("ggsegExtra.smoothness")} or the
\code{GGSEGEXTRA_SMOOTHNESS} environment variable. Default is 5.}

\item{verbose}{Control verbosity. If not specified, uses the value from
\code{options("ggsegExtra.verbosity")} or the \code{GGSEGEXTRA_VERBOSITY}
environment variable. Can be:
\itemize{
\item \code{TRUE} or \code{1}: Normal verbosity (default)
\item \code{FALSE} or \code{0}: Silent
\item \code{2}: High verbosity (includes FreeSurfer verbose output)
Use \code{\link[=set_verbosity]{set_verbosity()}} to change the default globally.
}}

\item{cleanup}{Remove intermediate files after atlas creation. If not
specified, uses \code{options("ggsegExtra.cleanup")} or the \code{GGSEGEXTRA_CLEANUP}
environment variable. Default is TRUE.}

\item{skip_existing}{Skip generating output files that already exist,
allowing interrupted atlas creation to resume. If not specified, uses
\code{options("ggsegExtra.skip_existing")} or the \code{GGSEGEXTRA_SKIP_EXISTING}
environment variable. Default is TRUE.}
}
\value{
An sf data.frame with columns \code{label}, \code{side} (view name), and
\code{geometry}.
}
\description{
Generate polygon outlines for tract visualisation in 2D. The function
projects tract centerlines onto slice views (coronal, axial) and extracts
contours. Also creates cortex outlines for anatomical context.
}
\details{
This is typically called automatically by \code{\link[=create_tract_atlas]{create_tract_atlas()}} when
\code{include_geometry = TRUE}, but you can call it separately if you want
custom views or need to regenerate geometry.
}
\keyword{internal}
